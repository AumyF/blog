export const metadata = {
  title: "オブジェクト指向をどう捉えているか",
  description:
    "20世紀生まれ新進気鋭のプログラマはオブジェクト指向についてどのような捉え方をしているのか？",
};

# はじめに

**オブジェクト指向** (OO: object oriented) という考え方がある。この単語は誕生してからたった数十年程度で

## この記事で扱わないもの

メッセージパッシング、アランケイ、Smalltalk。

# 対象指向

僕がオブジェクト指向の本質として考えているのは、対象指向ということだ。DOM (document object model) で例を見よう。DOM は HTML や XML の要素をプログラミング言語から操作するための、名前の通りオブジェクト指向を採用した API だ。

`id` 属性が `app` である要素を取得し、その子要素としてテキストノードを追加するコードは以下のようになる。

```
const container = document.querySelector("#app");

const child = document.createTextNode("Hello, DOM");

container.appendChild(child);
```

これはオブジェクト指向 UI という考えにも似ている。OOUI とは要するにオブジェクトに操作ボタンがくっついていう UI のことを指す。Twitter のツイートなどは OOUI のわかりやすい例だ。Twitter を開くとツイートの羅列が表示され、内容を読み、ユーザーはツイートというオブジェクトに対してリプライ、いいね、リツイートといった操作が行える。これがもし、Twitter を開いたとき「ツイートを見る」「ツイートにいいねする」「ツイートにリプライ」するというボタンが並べられた画面が開くというふうだったら使いづらいと感じるだろう。これはタスク指向をよばれ、OOUI は以下のようにボロクソにこき下ろされている (個人的にはやや過剰であるような気はしている)。

> 引用引用引用

オブジェクト指向な API を使っていてよいと感じるのは、値の右に `.` を書くだけで「これに対してはこういう操作ができますよ」ということを language service が教えてくれるということだ。浮かび上がってきた補完 UI を矢印キーでぽちぽちして必要そうなメソッドを探すことができる。API ドキュメントを読めという話な気もするが、怠惰なので。

# 型と密結合したモジュール

前節では OO な API はうれしいという話をした。じゃあプログラミング言語でそれをどうやって実装するかという話になるかと思う。ここでよく使われるのが型と密結合したモジュールという概念だ。この言葉は「F#を知ってほしい」からの引用で、OOP の本質をよく捉えていると感じる。ここではモジュールはかなり雑な定義として、名前空間を区切る、関数の集まりとする。

型と密結合したモジュールという概念は Rust だとわかりやすい。Rust ではメソッド (と関連関数) は `impl` ブロックに定義する。

```rust
struct Rect {
  width: f64,
  height: f64,
}

impl Rect {
  fn area(&self) -> f64 {
    self.width * self.height
  }
}

#[test]
fn test() {
  let rect = Rect {
    width: 100.0,
    height: 50.0,
  };
  assert_eq!(rect.area(), 5000.0);
}
```

`mod` ではなく、`impl` を使ってこそいるが、その中には関数が定義され、名前空間は外から隔離されている。これはほとんどモジュールといっていい。違うのはこのモジュールは `Rect` 型にくっついているということだ。そしてメソッド呼び出しというのは左辺値の型に密結合したモジュールの関数を呼び出す儀式だ。`rect` が `Rect` 型である以上 `area` が `Rect` 型に所属するメソッドであるのは自明なことであり、`Rect::` といった無粋な修飾子などは必要としない。

ではこのような分離がなされていない言語、たとえばクラスベース言語ではどうか。Kotlin で実例を見る。

```scala
class Rect(width: Float, height: Float) {
  shape(): Float = {
    this.width * this.height
  }
}
```

データ構造の定義とメソッドがごっちゃになってはいるが型と密結合したモジュールといえるだろう。
